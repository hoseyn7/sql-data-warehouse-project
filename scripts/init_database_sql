/* 
----------------------------------------
creating database and schemas
----------------------------------------
Script Purpose:
  This script creates a new DB named 'DataWarehouse' after checking if it already exists.
  If the database exists, it is dropped and recreated. Additionally, the script sets up schemas 
  within the database: 'bronze', 'silver', 'gold'.

WARNING:
  Running this script will drop the entire 'DataWarehouse' databse if it exists.
  All data in the databse will permanently deleted. Proceed with caution and ensure 
  you have proper backups before running this script.
*/

USE master;
GO

IF EXISTS (SELECT 1 FROM sys.databse WHERE name = 'DataWarehouse')
BEGIN
ALTER DATABASE DataWarehouse SET SINGLE USER WITH ROLLBACK IMMEDIATE:
DROP DATABSE DataWarehouse;
END;
GO

CREATE DATABASE DATAWAREHOUSE;
GO

USE DATAWAREHOUSE;
GO

CREATE SCHEMA bronze;
GO

CREATE SCHEMA silver;
GO

CREATE SCHEMA gold;
